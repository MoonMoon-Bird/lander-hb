;(self.SPZ=self.SPZ||[]).push({n:"spz-menu",ev:"0.1",l:!0,t:"v1",v:"1.0",m:0,f:function(e,t){!function(){var t;function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return(i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var s="spz-menu-root",r="spz-menu-item",f="spz-menu-submenu",l="spz-menu-inline-submenu",a="spz-menu-more-link",c="finish",h="default",m="template",p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t)}(d,e);var n,p,v,y,b=(v=d,y=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=o(v);if(y){var n=o(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return u(this,e)});function d(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),(t=b.call(this,e)).templates_=SPZServices.templatesForDoc(),t.mode_=h,t.container_=null,t.menuRoot_=null,t.moreLink_=null,t.moreLinkMenu_=null,t.menuItems_=[],t.hasMoreLink_=!1,t.moreLinkItems_=[],t.withMenuFlagItems_=[],t.unMutationObservers_=[],t}return n=d,(p=[{key:"isLayoutSupported",value:function(e){return e==SPZCore.Layout.CONTAINER||SPZCore.isLayoutSizeFixed(e)}},{key:"buildCallback",value:function(){var e=this;this.viewport_=this.getViewport(),this.registerAction("updateMoreLink",(function(){e.hasMoreLink_&&e.handleMoreLink_()}))}},{key:"unmountCallback",value:function(){this.unMutationObservers_.forEach((function(e){return e()}))}},{key:"waitForMoreLink_",value:function(){var e=this;return new Promise((function(t,n){SPZCore.Dom.waitForChild(e.element,(function(){return!!SPZCore.Dom.scopedQuerySelector(e.element,"[".concat(a,"]"))}),(function(){t()}),(function(){n()}))}))}},{key:"trySetMoreLink_",value:function(){this.moreLink_=SPZCore.Dom.scopedQuerySelector(this.element,"[".concat(a,"]")),this.hasMoreLink_=!!this.moreLink_}},{key:"mountCallback",value:function(){var e,t=this;if(this.trySetMoreLink_(),this.hasMoreLink_)this.initMoreLink_();else if("loading"!=(e=self.document).readyState&&"uninitialized"!=e.readyState){if(this.trySetMoreLink_(),!this.hasMoreLink_)return void SPZCore.Dom.toggleAttribute(this.element,c,!0);this.initMoreLink_()}else this.waitForMoreLink_().then((function(){t.trySetMoreLink_(),t.initMoreLink_()})).catch((function(){SPZCore.Dom.toggleAttribute(t.element,c,!0)}))}},{key:"initMoreLink_",value:function(){this.hasMoreLink_&&(this.initialize_(),this.registerMutationObserver_(),this.handleMoreLink_(),this.viewport_.onResize(this.handleMoreLink_.bind(this)),SPZCore.Dom.toggleAttribute(this.element,c,!0))}},{key:"initialize_",value:function(){var e=this;this.menuRoot_=SPZCore.Dom.scopedQuerySelector(this.element,"[".concat(s,"]"))||this.element.firstElementChild,SPZCore.Dom.toggleAttribute(this.menuRoot_,s,!0),this.moreLinkMenu_=SPZCore.Dom.scopedQuerySelector(this.moreLink_,"[".concat(f,"]")),this.moreLinkSubElements_=SPZCore.Types.toArray(SPZCore.Dom.scopedQuerySelectorAll(this.moreLink_,"> *:not([".concat(f,"])"))),this.menuItems_=this.getMenuItems_(),this.menuItems_.concat(this.moreLink_).forEach((function(e){SPZCore.Dom.toggleAttribute(e,r,!0)})),this.templates_.hasTemplate(this.element)?this.mode_=m:(this.moreLinkItems_=this.menuItems_.map((function(e){return e.removeAttribute(l),e.setAttribute(r,""),e.cloneNode(!0)})),this.moreLinkItems_.forEach((function(t){return e.moreLinkMenu_.appendChild(t)}))),this.element.setAttribute("mode",this.mode_)}},{key:"createMutationObserver_",value:function(e){var t=this,n=new(self.MutationObserver||self.WebKitMutationObserver)((function(){t.handleMoreLink_()}));n.observe(e,{childList:!0,subtree:!0}),this.unMutationObservers_.push((function(){return n.disconnect()}))}},{key:"registerMutationObserver_",value:function(){var e=this;this.moreLinkSubElements_.forEach((function(t){e.createMutationObserver_(t)}))}},{key:"getMenuItems_",value:function(){return SPZCore.Types.toArray(SPZCore.Dom.scopedQuerySelectorAll(this.menuRoot_,"> *:not([".concat(a,"])")))}},{key:"toggleVisible_",value:function(e,t){e.forEach((function(e){SPZCore.Dom.toggle(e,t)}))}},{key:"handleElementTransition_",value:function(e,t){t?(e.classList.remove("i-spzhtml-layout-fill"),SPZCore.Dom.setStyles(e,{"z-index":"auto","opacity":1})):(e.classList.add("i-spzhtml-layout-fill"),SPZCore.Dom.setStyles(e,{"z-index":-1e5,"opacity":0}))}},{key:"renderTemplate_",value:function(e){var n=this;return this.moreLinkMenu_?this.mutateElement((function(){n.templates_.findAndRenderTemplate(n.element,{offset:e}).then((function(e){n.container_?(n.handleElementTransition_(e,!1),n.moreLinkMenu_.appendChild(e),n.handleElementTransition_(n.container_,!1),n.handleElementTransition_(e,!0),SPZCore.Dom.removeElement(n.container_)):(n.moreLinkMenu_.appendChild(e),n.handleElementTransition_(e,!0)),n.container_=e}))})):t||(t=Promise.resolve(void 0))}},{key:"setSubmenuPosition_",value:function(e){var t=SPZCore.Types.toArray(e.children).find((function(e){return e.hasAttribute(f)}));if(t){var n=e.getBoundingClientRect(),i=t.getBoundingClientRect(),u=n.x-i.width,o=n.y;this.mutateElement((function(){SPZCore.Dom.setStyles(t,{left:u+"px",top:o+"px"})}))}}},{key:"handleMoreLinkMouseover_",value:function(e){var t=SPZCore.Dom.closestAncestorElementBySelector(this.assert(e.target),"[".concat(r,"], [").concat(f,"], [").concat(l,"]"));t&&(this.withMenuFlagItems_.some((function(e){return t.contains(e)||e.contains(t)}))?this.withMenuFlagItems_.push(t):this.withMenuFlagItems_=[t],this.setSubmenuPosition_(t))}},{key:"handleDefaultMode_",value:function(){var e=this;SPZUtils.Event.listen(this.moreLink_,"mouseover",this.handleMoreLinkMouseover_.bind(this)),this.getViewport().onScroll((function(){e.withMenuFlagItems_.forEach((function(t){return e.setSubmenuPosition_(t)}))}))}},{key:"handleMoreLink_",value:function(){var e=this.menuItems_;this.toggleVisible_(e.concat(this.moreLink_),!0);var t=this.element.clientWidth,n=[],i=e.reduce((function(e,t,i){var u=t.clientWidth;return e+=u,n[i]=u+(n[i-1]||0),e}),0),u=this.moreLink_.clientWidth;if(t>=i)SPZCore.Dom.toggle(this.moreLink_,!1);else{var o=n.findIndex((function(e){return e+u>t}));this.toggleVisible_(e.slice(o),!1),this.mode_===m?this.renderTemplate_(o):this.mode_===h&&(this.toggleVisible_(this.moreLinkItems_.slice(0,o),!1),this.toggleVisible_(this.moreLinkItems_.slice(o),!0),this.handleDefaultMode_())}}}])&&function(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}(n.prototype,p),Object.defineProperty(n,"prototype",{writable:!1}),d}(e.BaseElement);self.SPZ.registerElement("spz-menu",p,"spz-menu{position:static!important}spz-menu.i-spzhtml-layout-size-defined[open]{overflow:visible!important}spz-menu [spz-menu-root]{background:#fff;display:-ms-flexbox;display:flex;-ms-flex-align:start;align-items:flex-start}spz-menu [spz-menu-submenu]{display:none}spz-menu[mode=default] [spz-menu-more-link] [spz-menu-submenu] [spz-menu-submenu]{z-index:1030;position:fixed;left:0}spz-menu[mode=default] [spz-menu-more-link] [spz-menu-inline-submenu]>[spz-menu-submenu]{top:0}spz-menu [spz-menu-inline-submenu]:hover>[spz-menu-submenu],spz-menu [spz-menu-item]:hover>[spz-menu-submenu]{display:block}spz-menu ul{margin:0;padding:0;list-style-type:none!important}\n/*# sourceURL=/extensions/spz-menu/0.1/spz-menu.css*/")}()}});