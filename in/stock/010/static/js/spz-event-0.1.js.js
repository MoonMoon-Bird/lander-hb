;(self.SPZ=self.SPZ||[]).push({n:"spz-event",ev:"0.1",l:!0,t:"v1",v:"1.0",m:0,f:function(t,e){!function(){function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function i(t,e){return(i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function r(t,n){if(n&&("object"===e(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var o="spz-event",s="message",c="window",f=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&i(t,e)}(y,e);var f,a,l,h,v,d=(h=y,v=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=u(h);if(v){var n=u(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return r(this,t)});function y(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,y),(e=d.call(this,t)).targetElement_=null,e.eventName_=null,e.storageKey_=null,e}return f=y,l=[{key:"deferredMount",value:function(){return!1}}],(a=[{key:"buildCallback",value:function(){this.action_=SPZServices.actionServiceForDoc(this.element),this.assert(this.eventName_=this.element.getAttribute("event-name"),'"event-name" attribute required.%s',o),this.element.hasAttribute("observer-id")&&this.assert(this.observerId_=this.element.getAttribute("observer-id"),'"observer-id" attribute required.%s',o),this.element.hasAttribute("target-id")&&this.assert(this.targetID_=this.element.getAttribute("target-id"),'"target-id" attribute required.%s',o),this.targetApi_=this.element.getAttribute("target-api")||"render",this.element.hasAttribute("keep-status")&&(this.storageKey_="".concat(this.eventName_,"_").concat(this.observerId_,"_").concat(this.targetID_,"_").concat(this.targetApi_)),this.manual_=this.element.hasAttribute("manual"),this.setupAction_()}},{key:"isLayoutSupported",value:function(t){return t==SPZCore.Layout.LOGIC}},{key:"setupAction_",value:function(){var t,e=this;this.storageKey_&&null!==(t=this.win.localStorage)&&void 0!==t&&t.getItem(this.storageKey_)||(this.registerAction("unListen",(function(t){var n,i=null==t||null===(n=t.args)||void 0===n?void 0:n.eventName;e.isUnListen=!0,i&&e["".concat(i,"Listen")]&&e["".concat(i,"Listen")]()})),this.initDelayAction_(),this.initListenAction_())}},{key:"initDelayAction_",value:function(){var t=this;this.delay_=Number(this.element.getAttribute("delay"))||0,this.oldTime_=(new Date).getTime(),this.delay_&&SPZServices.timerFor(this.win).poll(1e3,(function(){if(t.isUnListen)return!0;(new Date).getTime()-t.oldTime_>=t.delay_&&t.triggerApi_()}))}},{key:"initListenAction_",value:function(){var t=this;this.eventName_.split(";").filter((function(t){return t})).forEach((function(e){t.observerId_&&t.observerId_!==c?SPZCore.Dom.waitForChild(document.body,(function(){return!!document.getElementById(t.observerId_)}),t.initListenEvent_.bind(t,e,document.getElementById(t.observerId_))):t.initListenEvent_(e,t.observerId_||t.win.document)}))}},{key:"initListenEvent_",value:function(t,e){var n=this;t!==s||e!==c?this["".concat(t,"Listen")]=SPZUtils.Event.listen(e,t,(function(t){n.delay_||n.triggerApi_(n.manual_?t.detail||{}:null),n.oldTime_=(new Date).getTime()}),{passive:!0}):window.addEventListener(s,(function(t){n.trigger_(s,t.data)}))}},{key:"triggerApi_",value:function(e){var n=this;SPZCore.Dom.waitForChild(document.body,(function(){return!!document.getElementById(n.targetID_)}),(function(){n.targetElement_||(n.targetElement_=document.getElementById(n.targetID_)),t.whenApiDefined(n.targetElement_).then((function(t){var i;t[n.targetApi_](e),n.storageKey_&&(null===(i=n.win.localStorage)||void 0===i||i.setItem(n.storageKey_,Date.now()))}))}))}},{key:"trigger_",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=SPZUtils.Event.create(this.win,"".concat(o,".").concat(t),e);this.action_.trigger(this.element,t,n)}}])&&n(f.prototype,a),l&&n(f,l),Object.defineProperty(f,"prototype",{writable:!1}),y}(t.BaseElement);self.SPZ.registerElement(o,f)}()}});